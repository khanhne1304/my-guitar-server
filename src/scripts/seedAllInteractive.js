import { spawn } from 'child_process';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

console.log('üöÄ B·∫Øt ƒë·∫ßu seed d·ªØ li·ªáu kh√≥a h·ªçc t∆∞∆°ng t√°c...\n');

// Danh s√°ch c√°c script c·∫ßn ch·∫°y theo th·ª© t·ª±
const scripts = [
  'seedAdmin.js',
  'seedInteractiveCourses.js',
  'seedLessonData.js'
];

async function runScripts() {
  for (const script of scripts) {
    console.log(`üìù ƒêang ch·∫°y ${script}...`);
    
    try {
      await new Promise((resolve, reject) => {
        const child = spawn('node', [path.join(__dirname, script)], {
          stdio: 'inherit',
          shell: true
        });
        
        child.on('close', (code) => {
          if (code === 0) {
            console.log(`‚úÖ Ho√†n th√†nh ${script}\n`);
            resolve();
          } else {
            console.log(`‚ùå L·ªói khi ch·∫°y ${script} (exit code: ${code})\n`);
            reject(new Error(`Script ${script} failed with exit code ${code}`));
          }
        });
        
        child.on('error', (error) => {
          console.log(`‚ùå L·ªói khi ch·∫°y ${script}:`, error.message);
          reject(error);
        });
      });
    } catch (error) {
      console.log(`‚ö†Ô∏è  B·ªè qua ${script} do l·ªói:`, error.message);
      // Ti·∫øp t·ª•c ch·∫°y script ti·∫øp theo
    }
  }
  
  console.log('üéâ Ho√†n th√†nh seed d·ªØ li·ªáu kh√≥a h·ªçc t∆∞∆°ng t√°c!');
  console.log('\nüìã D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c t·∫°o:');
  console.log('   - Admin user');
  console.log('   - Kh√≥a h·ªçc t∆∞∆°ng t√°c v·ªõi metronome');
  console.log('   - Fingerstyle guitar t∆∞∆°ng t√°c');
  console.log('   - Guitar lead t∆∞∆°ng t√°c');
  console.log('   - B√†i h·ªçc v·ªõi tabData chi ti·∫øt');
  console.log('   - Timeline v√† exercises');
  console.log('   - Feedback v√† th·ªëng k√™');
}

runScripts().catch((error) => {
  console.error('‚ùå L·ªói khi seed d·ªØ li·ªáu:', error.message);
  process.exit(1);
});








